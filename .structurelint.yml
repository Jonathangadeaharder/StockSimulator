# structurelint configuration
# Generated by: structurelint --init
# Documentation: https://github.com/structurelint/structurelint

root: true

exclude:
  - testdata/**
  - .git/**
  - __pycache__/**
  - .pytest_cache/**
  - venv/**
  - .venv/**

rules:
  # Phase 0: Basic filesystem structure
  max-depth:
    max: 5

  max-files-in-dir:
    max: 45

  max-subdirs:
    max: 13

  disallowed-patterns:
    - "*.tmp"
    - "*.bak"
    - ".DS_Store"
    - "*.pyc"
    - "*.pyo"
    - "*.swp"
    - "*~"
    - ".env.local"
    - ".env.*.local"

  # Test file validation
  # Detected: python with separate test pattern
  test-adjacency:
    pattern: "separate"
    test-dir: "tests"
    file-patterns:
      - "**/*.py"
    exemptions:
      - "**/__init__.py"    # Package initializers
      - "**/conftest.py"    # Pytest configuration
      - "setup.py"          # Setup script

  test-location:
    integration-test-dir: "tests"  # Default integration test directory
    allow-adjacent: false
    exemptions:
      - "testdata/**"

  # Naming conventions for Python
  naming-convention:
    dirs: "snake_case"
    files: "snake_case"
    exemptions:
      - "README.md"
      - "LICENSE"
      - "CONTRIBUTING.md"
      - "*.md"

# Phase 1: Architectural layers
layers:
  # Define layers for the stocksimulator package
  - name: "models"
    path: "src/stocksimulator/models/**"
    can-import:
      - "src/stocksimulator/models/**"

  - name: "data"
    path: "src/stocksimulator/data/**"
    can-import:
      - "src/stocksimulator/data/**"
      - "src/stocksimulator/models/**"

  - name: "downloaders"
    path: "src/stocksimulator/downloaders/**"
    can-import:
      - "src/stocksimulator/downloaders/**"
      - "src/stocksimulator/models/**"

  - name: "indicators"
    path: "src/stocksimulator/indicators/**"
    can-import:
      - "src/stocksimulator/indicators/**"
      - "src/stocksimulator/models/**"

  - name: "core"
    path: "src/stocksimulator/core/**"
    can-import:
      - "src/stocksimulator/core/**"
      - "src/stocksimulator/models/**"
      - "src/stocksimulator/data/**"
      - "src/stocksimulator/indicators/**"

  - name: "strategies"
    path: "src/stocksimulator/strategies/**"
    can-import:
      - "src/stocksimulator/strategies/**"
      - "src/stocksimulator/models/**"
      - "src/stocksimulator/indicators/**"
      - "src/stocksimulator/core/**"

  - name: "optimization"
    path: "src/stocksimulator/optimization/**"
    can-import:
      - "src/stocksimulator/optimization/**"
      - "src/stocksimulator/models/**"
      - "src/stocksimulator/core/**"
      - "src/stocksimulator/strategies/**"

  - name: "simulation"
    path: "src/stocksimulator/simulation/**"
    can-import:
      - "src/stocksimulator/simulation/**"
      - "src/stocksimulator/models/**"
      - "src/stocksimulator/core/**"
      - "src/stocksimulator/strategies/**"

  - name: "reporting"
    path: "src/stocksimulator/reporting/**"
    can-import:
      - "src/stocksimulator/reporting/**"
      - "src/stocksimulator/models/**"
      - "src/stocksimulator/core/**"

  - name: "tax"
    path: "src/stocksimulator/tax/**"
    can-import:
      - "src/stocksimulator/tax/**"
      - "src/stocksimulator/models/**"

# Phase 2: Dead code detection
entrypoints:
  - "setup.py"
  - "examples/**/*.py"
  - "historical_data/**/*.py"
  - "tests/**/*.py"
